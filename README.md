# Bus Passengers Classification
В этом репозитории я продемонстрирую свою работу над решением задачи классификации Входящих и Выходящих людей из автобуса по изображениям с видео камер.
# Данные о датасете
**Ссылка на используемый датасет:** https://storage.yandexcloud.net/aiueducation/Content/base/l4/bus.zip.

Датасет представляет из себя две папки: Входящий - в которой лежит 6485 фото с входящими людьми, Выходящий - в которой лежит 2596 фото с выходящими людьми. Многие фото имеют разный размер.
# Входные данные
Входные данные представлены изобажениями различного размера. Чтобы привести их к одному размеру я решил найти среднее значение всех изображений, чтобы добиться наименьших искажений. Так, я получил, что среднее разрешениие изображения должно быть ~ (342x207x3) pix.

**Пример Входного изображения:**
![image](https://user-images.githubusercontent.com/78702396/177956819-2074c5ee-cf3b-4e43-a189-8131debd5520.png)
# Выходные данные
В качестве задачи стоит бинарная классификация, поэтому НС будет обладать одним выходом в диапазоне (0 .. 1), где 1 - человек выходит из транспорта, а 0 - человек заходит в транспорт. 
# Результаты
Проведя серию экспериментов я пришёл к, на мой взгляд, очень не плохой модели. Для начала стоит уточнить разбиение датасета на выборки. Я сделал это следующим образом: 81/9/10 в процентах соответственно (тренировочная/проверочная/тестовая). 

Таким образом, её точность на тренировочной выборке составила:

`99.9%` на тренировочной выборке (7354 фото)

`98.7%` на проверочной выборке (818 фото)

`99%` на тестовой выборке (909 фото).

Поставленная задача была успешно выполнена. Архитектура НС, показавшая наилучший результат, представлена ниже.

![model](https://user-images.githubusercontent.com/78702396/177962108-4255e620-2ff0-42ca-bc59-a5c46e6dddaa.png)

Результаты обучения так же предсавлениы ниже:

Первые 50 эпох обучения с шагом обучения 1е-4:

![image](https://user-images.githubusercontent.com/78702396/177963165-6730de23-6c59-4e7a-8a26-b0d84687769e.png)

Дообучение на 20ти эпохах с шагом обучения 1е-6:

![image](https://user-images.githubusercontent.com/78702396/177963289-f403a6cc-d95e-4345-88e5-a7a130ddfc2a.png)

# Стек используемых библиотек
```import gdown
import os
import numpy as np
import pickle
import matplotlib.pyplot as plt
import sklearn
import keras
import tensorflow (2.4)
```
# Был рад поделиться своей работой
